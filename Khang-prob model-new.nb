(* Content-type: application/vnd.wolfram.mathematica *)



(*** Wolfram Notebook File ***)

(* http://www.wolfram.com/nb *)



(* CreatedBy='Mathematica 9.0' *)



(*CacheID: 234*)

(* Internal cache information:

NotebookFileLineBreakTest

NotebookFileLineBreakTest

NotebookDataPosition[       157,          7]



NotebookDataLength[     33823,        807]

NotebookOptionsPosition[     32832,        772]

NotebookOutlinePosition[     33177,        787]

CellTagsIndexPosition[     33134,        784]



WindowFrame->Normal*)



(* Beginning of Notebook Content *)

Notebook[{

Cell[BoxData[{

 RowBox[{

  RowBox[{"pathdesk", "=", 

   RowBox[{

   "$InitialDirectory", "<>", "\"\<\\\\Physician-Workforce-Model\\\\\>\""}]}],

   ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"SetDirectory", "[", "pathdesk", "]"}], 

  ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"raw", "=", 

   RowBox[{"Import", "[", 

    RowBox[{

    "\"\<Overall Probability-extracted-short-new.csv\>\"", ",", 

     "\"\<CSV\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"divisions", "=", 

   RowBox[{"Prepend", "[", 

    RowBox[{

     RowBox[{"Table", "[", 

      RowBox[{

       RowBox[{

        RowBox[{"Flatten", "[", 

         RowBox[{"Position", "[", 

          RowBox[{

           RowBox[{"raw", "[", 

            RowBox[{"[", 

             RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "i"}], "]"}], 

         "]"}], "[", 

        RowBox[{"[", 

         RowBox[{"-", "1"}], "]"}], "]"}], ",", 

       RowBox[{"{", 

        RowBox[{"i", ",", "1", ",", 

         RowBox[{"raw", "[", 

          RowBox[{"[", 

           RowBox[{

            RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 

     ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"Specialties", "=", 

   RowBox[{"Drop", "[", 

    RowBox[{"GatherBy", "[", 

     RowBox[{"raw", ",", 

      RowBox[{

       RowBox[{"#", "[", 

        RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 

  ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"ExtractedSpecs", "=", 

   RowBox[{"Map", "[", 

    RowBox[{

     RowBox[{

      RowBox[{"#", "[", 

       RowBox[{"[", 

        RowBox[{"All", ",", 

         RowBox[{"3", ";;", 

          RowBox[{"-", "1"}]}]}], "]"}], "]"}], "&"}], ",", "Specialties"}], 

    "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"speclengths", "=", 

   RowBox[{"Map", "[", 

    RowBox[{"Length", ",", "ExtractedSpecs"}], "]"}]}], 

  ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"fullinputs", "=", 

   RowBox[{"raw", "[", 

    RowBox[{"[", 

     RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{

  RowBox[{"fulloperate", "=", 

   RowBox[{"raw", "[", 

    RowBox[{"[", 

     RowBox[{"All", ",", 

      RowBox[{"3", ";;", 

       RowBox[{"-", "1"}]}]}], "]"}], "]"}]}], 

  ";"}], "\[IndentingNewLine]"}], "Input",

 CellChangeTimes->{{3.605531675583222*^9, 3.6055317252130604`*^9}, {

   3.605531864876049*^9, 3.605531901483143*^9}, {3.605549190946043*^9, 

   3.6055491935541925`*^9}, {3.6060421161007495`*^9, 3.606042285195421*^9}, {

   3.6060424362030582`*^9, 3.6060424678258667`*^9}, {3.6060425045939703`*^9, 

   3.606042521882959*^9}, {3.6060441002472363`*^9, 3.606044118792297*^9}, {

   3.6060441539993105`*^9, 3.606044318350711*^9}, 3.606048425352618*^9, {

   3.606048472999343*^9, 3.6060484848790226`*^9}, {3.6060494281709757`*^9, 

   3.6060494320091953`*^9}, {3.608552005296875*^9, 3.608552049453125*^9}, 

   3.6085524104375*^9, {3.6085524490625*^9, 3.608552476609375*^9}}],



Cell[BoxData[

 RowBox[{"\[IndentingNewLine]", 

  RowBox[{"(*", " ", 

   RowBox[{

   "This", " ", "module", " ", "defines", " ", "the", " ", "functions", " ", 

    "used", " ", "in", " ", "executing", " ", "the", " ", "probit", " ", 

    "regression"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 

  RowBox[{"(*", 

   RowBox[{

    RowBox[{

    "\"\<n\>\"", " ", "must", " ", "be", " ", "a", " ", "positive", " ", 

     "integer"}], ",", " ", 

    RowBox[{

    "and", " ", "\"\<x\>\"", " ", "a", " ", "set", " ", "of", " ", 

     "reals"}]}], "*)"}], "\[IndentingNewLine]", 

  RowBox[{

   RowBox[{

    RowBox[{"dist", "[", 

     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 

    RowBox[{"N", "[", 

     RowBox[{"CDF", "[", 

      RowBox[{

       RowBox[{"ChiSquareDistribution", "[", 

        RowBox[{"n", "-", "1"}], "]"}], ",", "x"}], "]"}], "]"}]}], 

   "\[IndentingNewLine]", "\[IndentingNewLine]", 

   RowBox[{"(*", 

    RowBox[{

    "\"\<set\>\"", " ", "must", " ", "be", " ", "a", " ", "set", " ", "of", 

     " ", "reals"}], "*)"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"Analyze", "[", "set_", "]"}], ":=", 

    RowBox[{"Module", "[", 

     RowBox[{

      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 

      RowBox[{

       RowBox[{"output", "=", 

        RowBox[{"set", "[", 

         RowBox[{"[", 

          RowBox[{"All", ",", 

           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"l", "=", 

        RowBox[{

         RowBox[{"Length", "[", 

          RowBox[{"set", "[", 

           RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"vec", "=", 

        RowBox[{"ToExpression", "[", 

         RowBox[{"Table", "[", 

          RowBox[{

           RowBox[{"\"\<x\>\"", "<>", 

            RowBox[{"ToString", "[", "i", "]"}]}], ",", 

           RowBox[{"{", 

            RowBox[{"i", ",", "1", ",", "l"}], "}"}]}], "]"}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"NN", "=", 

        RowBox[{"Length", "[", "set", "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"probit", "=", 

        RowBox[{"ProbitModelFit", "[", 

         RowBox[{"set", ",", "vec", ",", "vec"}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"modeloutput", "=", 

        RowBox[{"Round", "[", 

         RowBox[{"probit", "[", "\"\<PredictedResponse\>\"", "]"}], "]"}]}], 

       ";", "\[IndentingNewLine]", 

       RowBox[{"response", "=", 

        RowBox[{"probit", "[", "\"\<PredictedResponse\>\"", "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"(*", 

        RowBox[{"probit", "[", "\"\<ParameterTable\>\"", "]"}], "*)"}], 

       "\[IndentingNewLine]", 

       RowBox[{"analysis1", "=", 

        RowBox[{"modeloutput", "-", "output"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"correct", "=", 

        RowBox[{"N", "[", 

         RowBox[{

          RowBox[{"Count", "[", 

           RowBox[{"analysis1", ",", "0"}], "]"}], "/", 

          RowBox[{"Length", "[", "analysis1", "]"}]}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"(*", 

        RowBox[{

         RowBox[{"N", "[", 

          RowBox[{

           RowBox[{"Count", "[", 

            RowBox[{"analysis1", ",", "1"}], "]"}], "/", 

           RowBox[{"Length", "[", "analysis1", "]"}]}], "]"}], 

         "\[IndentingNewLine]", 

         RowBox[{"N", "[", 

          RowBox[{

           RowBox[{"Count", "[", 

            RowBox[{"analysis1", ",", 

             RowBox[{"-", "1"}]}], "]"}], "/", 

           RowBox[{"Length", "[", "analysis1", "]"}]}], "]"}]}], "*)"}], 

       "\[IndentingNewLine]", 

       RowBox[{"aic", "=", 

        RowBox[{"probit", "[", "\"\<AIC\>\"", "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"chi", "=", 

        RowBox[{"probit", "[", "\"\<PearsonChiSquare\>\"", "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"d", "=", 

        RowBox[{"dist", "[", 

         RowBox[{"NN", ",", "chi"}], "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"Return", "[", 

        RowBox[{"{", 

         RowBox[{"correct", ",", "aic", ",", "chi", ",", "d"}], "}"}], 

        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 

   RowBox[{"(*", " ", 

    RowBox[{"\"\<M\>\"", " ", "has", " ", "to", " ", "be", " ", 

     RowBox[{"a", " ", "\\", 

      RowBox[{"{", " ", 

       RowBox[{"set", " ", "\\"}], "}"}]}]}], " ", "*)"}], 

   "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"getoperate", "[", "M_", "]"}], ":=", 

    RowBox[{"Flatten", "[", 

     RowBox[{

      RowBox[{"ExtractedSpecs", "[", 

       RowBox[{"[", "M", "]"}], "]"}], ",", "1"}], "]"}]}]}]}]], "Input",

 CellChangeTimes->{{3.605531675583222*^9, 3.6055317252130604`*^9}, {

   3.605531864876049*^9, 3.605531941619438*^9}, {3.605531974819337*^9, 

   3.605532074227023*^9}, {3.6055321093630323`*^9, 3.605532111627162*^9}, {

   3.6055322031383963`*^9, 3.605532219322322*^9}, {3.6055323834167075`*^9, 

   3.6055324267211847`*^9}, {3.6055328098230968`*^9, 

   3.6055328153264112`*^9}, {3.605532961532774*^9, 3.605533277465844*^9}, {

   3.605533405707179*^9, 3.6055334167778125`*^9}, {3.605533467345705*^9, 

   3.605533481289502*^9}, {3.605533545385168*^9, 3.6055335500744367`*^9}, {

   3.6055336887523685`*^9, 3.605533689144391*^9}, {3.605533769590992*^9, 

   3.605533811039363*^9}, {3.60553395487959*^9, 3.605534092453459*^9}, {

   3.6055341257643642`*^9, 3.605534239053844*^9}, {3.605534291365836*^9, 

   3.6055342914768424`*^9}, {3.605534369253291*^9, 3.6055343693492966`*^9}, {

   3.6055344368681583`*^9, 3.6055344372441797`*^9}, {3.605534642770935*^9, 

   3.6055346586188416`*^9}, {3.605535346628194*^9, 3.6055353699175253`*^9}, {

   3.605535649713529*^9, 3.605535764171076*^9}, {3.605539860334363*^9, 

   3.6055398802225003`*^9}, {3.6055399140224333`*^9, 3.605539944710189*^9}, {

   3.605539986966606*^9, 3.6055400511252756`*^9}, {3.6055412035971932`*^9, 

   3.605541205010274*^9}, {3.605544874625164*^9, 3.605544889010987*^9}, {

   3.6055449293302927`*^9, 3.6055450459949656`*^9}, {3.605546443944924*^9, 

   3.605546456255628*^9}, {3.605546488968499*^9, 3.60554649684895*^9}, {

   3.6055465271846848`*^9, 3.6055465826548576`*^9}, {3.605546616231778*^9, 

   3.6055466193279552`*^9}, {3.605546668494767*^9, 3.605546671914963*^9}, {

   3.6055467052788715`*^9, 3.6055467088470755`*^9}, {3.6055467572468433`*^9, 

   3.605546916701964*^9}, {3.605546953205052*^9, 3.6055472074665947`*^9}, {

   3.605547611115682*^9, 3.605547617928072*^9}, 3.6055476705280805`*^9, 

   3.60554789361384*^9, {3.605612849756119*^9, 3.605612905699319*^9}, {

   3.6056130798972826`*^9, 3.605613124353825*^9}, {3.605613325375323*^9, 

   3.6056133459515*^9}, {3.6056134113762417`*^9, 3.605613416272522*^9}, {

   3.6056134484553623`*^9, 3.6056134747118645`*^9}, {3.605613504815586*^9, 

   3.6056135427267547`*^9}, {3.605613620735216*^9, 3.605613653366083*^9}, 

   3.6056139223164663`*^9, {3.6056139637128334`*^9, 3.605614015539798*^9}, {

   3.6056142891764493`*^9, 3.605614289694479*^9}, {3.605614659558634*^9, 

   3.605614665509974*^9}, {3.6056147279655466`*^9, 3.605614757662245*^9}, {

   3.605614792126216*^9, 3.605614809230194*^9}, {3.6056149375175323`*^9, 

   3.6056150445406537`*^9}, {3.605615222793849*^9, 3.6056152574988337`*^9}, {

   3.6056154189460683`*^9, 3.6056154195941052`*^9}, {3.605615488929071*^9, 

   3.6056155605691686`*^9}, {3.6056156206486053`*^9, 

   3.6056156571996956`*^9}, {3.6056156882964745`*^9, 3.605615701264216*^9}, {

   3.605615741671527*^9, 3.605615871726966*^9}, {3.6056164740584173`*^9, 

   3.6056165188979816`*^9}, {3.6056166104652195`*^9, 3.605616716240269*^9}, {

   3.6056167479280815`*^9, 3.605616751488285*^9}, {3.605616802360195*^9, 

   3.605616829527749*^9}, {3.605616987446781*^9, 3.60561704057382*^9}, {

   3.6056171135579944`*^9, 3.605617292524231*^9}, {3.6056173338925967`*^9, 

   3.605617472883547*^9}, {3.6056175388593206`*^9, 3.6056175521710815`*^9}, 

   3.6056175930424194`*^9, {3.605617627770406*^9, 3.605617816585205*^9}, {

   3.606042753139186*^9, 3.606043311895145*^9}, {3.60604389085926*^9, 

   3.606043994802205*^9}, {3.6060440300502214`*^9, 3.6060440851263714`*^9}, {

   3.606044324688073*^9, 3.6060445311348815`*^9}, {3.606045069810692*^9, 

   3.6060451035306206`*^9}, {3.606045133922359*^9, 3.6060452010982013`*^9}, {

   3.6060452928254476`*^9, 3.6060453266893845`*^9}, {3.6060453568411093`*^9, 

   3.606045356961116*^9}, {3.6060453946642723`*^9, 3.6060459158520827`*^9}, {

   3.6060459560763836`*^9, 3.606046076915295*^9}, {3.6060461085871067`*^9, 

   3.606046727774522*^9}, {3.6060467846787767`*^9, 3.606046890885852*^9}, {

   3.6060470445966434`*^9, 3.6060470455646987`*^9}, {3.6060471979074125`*^9, 

   3.6060472049628153`*^9}, {3.606048009157813*^9, 3.606048015445173*^9}, {

   3.6060481219732656`*^9, 3.606048131579815*^9}, {3.60604819180426*^9, 

   3.6060481947704296`*^9}, 3.606048267756604*^9, {3.60604830195256*^9, 

   3.606048538695101*^9}, {3.6060487605737915`*^9, 3.6060487611338234`*^9}, {

   3.60604880565337*^9, 3.6060489447183237`*^9}, {3.6060489770061707`*^9, 

   3.6060489990144296`*^9}, {3.6060491285978413`*^9, 3.606049162298769*^9}, {

   3.606051421483987*^9, 3.606051426595279*^9}, {3.608552053484375*^9, 

   3.60855212909375*^9}}],



Cell[BoxData[""], "Input",

 CellChangeTimes->{{3.606045832076291*^9, 3.606045834186412*^9}, {

  3.6060482223290057`*^9, 3.6060482258412066`*^9}}],



Cell[CellGroupData[{



Cell[BoxData[

 RowBox[{

  RowBox[{"(*", " ", 

   RowBox[{

    RowBox[{

     RowBox[{

     "\"\<fullset\>\"", " ", "is", " ", "the", " ", "collection", " ", "of", 

      " ", "actionable", " ", "sub"}], "-", "databases"}], ",", " ", 

    RowBox[{"corresponding", " ", "to", " ", "different", " ", 

     RowBox[{"specialties", "."}]}]}], "*)"}], "\[IndentingNewLine]", 

  RowBox[{"(*", " ", 

   RowBox[{

    RowBox[{"Those", " ", "specialties", " ", "are", "  ", "4"}], "=", 

    "\[IndentingNewLine]", "\t\t\t\t\t\t ", 

    RowBox[{"6", "=", "\[IndentingNewLine]", "\t\t\t\t\t\t", 

     RowBox[{"7", "=", "\[IndentingNewLine]", "\t\t\t\t\t\t", 

      RowBox[{"11", "=", "\[IndentingNewLine]", "\t\t\t\t\t\t", 

       RowBox[{"12", "="}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 

  "\[IndentingNewLine]", 

  RowBox[{

   RowBox[{

    RowBox[{"fullset", "=", 

     RowBox[{"{", 

      RowBox[{"4", ",", "6", ",", "7", ",", "11", ",", "12"}], "}"}]}], ";"}],

    "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"lentab", "=", 

     RowBox[{"{", "1", "}"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"For", "[", 

     RowBox[{

      RowBox[{"i", "=", "1"}], ",", 

      RowBox[{"i", "<=", 

       RowBox[{"Length", "[", "fullset", "]"}]}], ",", 

      RowBox[{"i", "++"}], ",", 

      RowBox[{"AppendTo", "[", 

       RowBox[{"lentab", ",", 

        RowBox[{

         RowBox[{"lentab", "[", 

          RowBox[{"[", 

           RowBox[{"-", "1"}], "]"}], "]"}], "+", 

         RowBox[{"speclengths", "[", 

          RowBox[{"[", 

           RowBox[{"fullset", "[", 

            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}]}], "]"}]}], "]"}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"binsamps", "=", 

     RowBox[{"BinLists", "[", 

      RowBox[{

       RowBox[{"Range", "[", 

        RowBox[{"Length", "[", "fulloperate", "]"}], "]"}], ",", 

       RowBox[{"{", "lentab", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate1", "=", 

     RowBox[{"getoperate", "[", 

      RowBox[{"{", 

       RowBox[{"4", ",", "6", ",", "7", ",", "11", ",", "12"}], "}"}], 

      "]"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{"(*", 

    RowBox[{

     RowBox[{"operate", "=", 

      RowBox[{"Transpose", "[", 

       RowBox[{"Drop", "[", 

        RowBox[{

         RowBox[{"Transpose", "[", "operate", "]"}], ",", 

         RowBox[{"{", 

          RowBox[{"5", ",", "6"}], "}"}]}], "]"}], "]"}]}], ";"}], "*)"}], 

   "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate1", "]"}], "\[IndentingNewLine]", 

   "\[IndentingNewLine]", 

   RowBox[{"Print", "[", "]"}], "\[IndentingNewLine]", 

   RowBox[{

   "Print", "[", 

    "\"\<Output format is {accuracy, AIC, Chi Square score, and p-value}\>\"",

     "]"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate", "=", 

     RowBox[{

      RowBox[{"getoperate", "[", 

       RowBox[{"{", "4", "}"}], "]"}], "[", 

      RowBox[{"[", 

       RowBox[{

        RowBox[{"binsamps", "[", 

         RowBox[{"[", "1", "]"}], "]"}], "-", 

        RowBox[{"binsamps", "[", 

         RowBox[{"[", 

          RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate", "=", 

     RowBox[{

      RowBox[{"getoperate", "[", 

       RowBox[{"{", "6", "}"}], "]"}], "[", 

      RowBox[{"[", 

       RowBox[{

        RowBox[{"binsamps", "[", 

         RowBox[{"[", "2", "]"}], "]"}], "-", 

        RowBox[{"binsamps", "[", 

         RowBox[{"[", 

          RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate", "=", 

     RowBox[{

      RowBox[{"getoperate", "[", 

       RowBox[{"{", "7", "}"}], "]"}], "[", 

      RowBox[{"[", 

       RowBox[{

        RowBox[{"binsamps", "[", 

         RowBox[{"[", "3", "]"}], "]"}], "-", 

        RowBox[{"binsamps", "[", 

         RowBox[{"[", 

          RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate", "=", 

     RowBox[{

      RowBox[{"getoperate", "[", 

       RowBox[{"{", "11", "}"}], "]"}], "[", 

      RowBox[{"[", 

       RowBox[{

        RowBox[{"binsamps", "[", 

         RowBox[{"[", "4", "]"}], "]"}], "-", 

        RowBox[{"binsamps", "[", 

         RowBox[{"[", 

          RowBox[{"4", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"operate", "=", 

     RowBox[{

      RowBox[{"getoperate", "[", 

       RowBox[{"{", "12", "}"}], "]"}], "[", 

      RowBox[{"[", 

       RowBox[{

        RowBox[{"binsamps", "[", 

         RowBox[{"[", "5", "]"}], "]"}], "-", 

        RowBox[{"binsamps", "[", 

         RowBox[{"[", 

          RowBox[{"5", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

    ";"}], "\[IndentingNewLine]", 

   RowBox[{"Analyze", "[", "operate", "]"}], 

   "\[IndentingNewLine]"}]}]], "Input",

 CellChangeTimes->{{3.6060480417386765`*^9, 3.606048056866542*^9}, {

   3.6060480881703324`*^9, 3.6060481066733904`*^9}, {3.6060481873060026`*^9, 

   3.606048300242462*^9}, 3.606048495335621*^9, {3.606048544263419*^9, 

   3.606048640125902*^9}, {3.606049169340172*^9, 3.6060492719800425`*^9}, {

   3.6060494023204975`*^9, 3.6060494204735355`*^9}, {3.606049466673178*^9, 

   3.6060494777098093`*^9}, {3.606049523472427*^9, 3.606049585216958*^9}, {

   3.606049617320795*^9, 3.6060497134802947`*^9}, {3.6060497552636843`*^9, 

   3.6060500016607776`*^9}, {3.6060500415510592`*^9, 3.606050155798594*^9}, {

   3.606050186469348*^9, 3.60605021272285*^9}, {3.606050243060585*^9, 

   3.606050739660989*^9}, {3.606050796784256*^9, 3.606051157521889*^9}, {

   3.606051194217988*^9, 3.606051262377887*^9}, {3.60605129338266*^9, 

   3.606051392429325*^9}, {3.6060514452203445`*^9, 3.6060515110451097`*^9}, {

   3.6060515495573125`*^9, 3.6060515675933437`*^9}, {3.606051606525571*^9, 

   3.6060516143200164`*^9}, {3.6060516485239725`*^9, 

   3.6060516824279118`*^9}, {3.60855248984375*^9, 3.60855262190625*^9}, {

   3.608552675796875*^9, 3.608552745328125*^9}}],





Cell[BoxData["\<\"\"\>"], "Print",

 CellChangeTimes->{{3.6060513932683735`*^9, 3.6060513999297543`*^9}, {

  3.606051449776605*^9, 3.6060515118491554`*^9}, {3.606051551668433*^9, 

  3.60605156840139*^9}, {3.606051666983029*^9, 3.6060516883422503`*^9}, {

  3.608552722921875*^9, 3.60855273053125*^9}}],





Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "0.7279411764705882`", ",", "435.0788726934511`", ",", 

   "406.60726229908227`", ",", "0.5038303501390637`"}], "}"}]], "Output",

 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {



   3.608552722921875*^9, 3.6085527466875*^9}}],





Cell[CellGroupData[{



Cell[BoxData["\<\"\"\>"], "Print",



 CellChangeTimes->{3.60855274675*^9}],



Cell[BoxData["\<\"Output format is {accuracy, AIC, Chi Square score, and \

p-value}\"\>"], "Print",

 CellChangeTimes->{3.60855274675*^9}]



}, Open  ]],



Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "0.6904761904761905`", ",", "57.85744381963178`", ",", 

   "35.281261597143896`", ",", "0.27794942288023117`"}], "}"}]], "Output",

 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {



   3.608552722921875*^9, 3.60855274690625*^9}}],




Cell[BoxData[

 RowBox[{"{", 

  RowBox[{



  "0.6818181818181818`", ",", "61.36108221523681`", ",", "38.42866014627729`",

    ",", "0.3303466093162045`"}], "}"}]], "Output",



 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {



   3.608552722921875*^9, 3.608552747359375*^9}}],




Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "0.8103448275862069`", ",", "65.76204556740642`", ",", "49.99787432326987`",

    ",", "0.2670972601463824`"}], "}"}]], "Output",

 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {


   3.608552722921875*^9, 3.6085527479375*^9}}],




Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "0.7628865979381443`", ",", "111.43102469019183`", ",", 

   "99.30125459288213`", ",", "0.6116301804616743`"}], "}"}]], "Output",

 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {


   3.608552722921875*^9, 3.608552748296875*^9}}],




Cell[BoxData[

 RowBox[{"{", 

  RowBox[{


  "0.8203592814371258`", ",", "154.306224782137`", ",", "164.93590821231066`",

    ",", "0.4912611977950017`"}], "}"}]], "Output",


 CellChangeTimes->{{3.6060512964848375`*^9, 3.606051318162077*^9}, 

   3.6060513492838573`*^9, {3.606051393267373*^9, 3.606051399927754*^9}, {

   3.606051449775605*^9, 3.6060515118471556`*^9}, {3.6060515516664333`*^9, 

   3.60605156839939*^9}, {3.6060516669820285`*^9, 3.6060516883412504`*^9}, {


   3.608552722921875*^9, 3.6085527488125*^9}}]


}, Open  ]],



Cell[CellGroupData[{



Cell[BoxData[

 RowBox[{"\[IndentingNewLine]", 

  RowBox[{

   RowBox[{

    RowBox[{"samps", "=", 

     RowBox[{"Sort", "[", 

      RowBox[{"RandomSample", "[", 

       RowBox[{

        RowBox[{"Range", "[", 

         RowBox[{"Length", "[", "operate1", "]"}], "]"}], ",", "250"}], "]"}],

       "]"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"compsamps", "=", 

     RowBox[{"Sort", "[", 

      RowBox[{"Complement", "[", 

       RowBox[{

        RowBox[{"Range", "[", 

         RowBox[{"Length", "[", "operate1", "]"}], "]"}], ",", "samps"}], 

       "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"bincompsamps", "=", 

     RowBox[{"BinLists", "[", 

      RowBox[{"compsamps", ",", 

       RowBox[{"{", "lentab", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 

   RowBox[{

    RowBox[{"Validate", "[", 

     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 

    RowBox[{"Module", "[", 

     RowBox[{

      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 

      RowBox[{

       RowBox[{"Print", "[", 

        RowBox[{"bincompsamps", "[", 

         RowBox[{"[", "b", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 

       RowBox[{"ClearAll", "[", "prob", "]"}], ";", "\[IndentingNewLine]", 

       RowBox[{"operate", "=", 

        RowBox[{

         RowBox[{"getoperate", "[", 

          RowBox[{"{", "a", "}"}], "]"}], "[", 

         RowBox[{"[", 

          RowBox[{

           RowBox[{"binsamps", "[", 

            RowBox[{"[", "b", "]"}], "]"}], "-", 

           RowBox[{"binsamps", "[", 

            RowBox[{"[", "b", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"Analyze", "[", "operate", "]"}], ";", "\[IndentingNewLine]", 

       RowBox[{

        RowBox[{"prob", "[", "y_", "]"}], ":=", 

        RowBox[{"Round", "[", 

         RowBox[{"Apply", "[", 

          RowBox[{

           RowBox[{"probit", "[", "\"\<Function\>\"", "]"}], ",", "y"}], 

          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"test", "=", 

        RowBox[{

         RowBox[{"getoperate", "[", 

          RowBox[{"{", "a", "}"}], "]"}], "[", 

         RowBox[{"[", 

          RowBox[{

           RowBox[{"bincompsamps", "[", 

            RowBox[{"[", "b", "]"}], "]"}], "-", 

           RowBox[{"bincompsamps", "[", 

            RowBox[{"[", "b", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"data", "=", 

        RowBox[{"test", "[", 

         RowBox[{"[", 

          RowBox[{"All", ",", 

           RowBox[{"1", ";;", "6"}]}], "]"}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"results", "=", 

        RowBox[{"test", "[", 

         RowBox[{"[", 

          RowBox[{"All", ",", 

           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"testout", "=", 

        RowBox[{"Map", "[", 

         RowBox[{"prob", ",", "data"}], "]"}]}], ";", "\[IndentingNewLine]", 

       RowBox[{"acc", "=", 

        RowBox[{"N", "[", 

         RowBox[{

          RowBox[{"Count", "[", 

           RowBox[{

            RowBox[{"testout", "-", "results"}], ",", "0"}], "]"}], "/", 

          RowBox[{"Length", "[", "results", "]"}]}], "]"}]}], ";", 

       "\[IndentingNewLine]", 

       RowBox[{"Return", "[", 

        RowBox[{"{", 

         RowBox[{"acc", ",", "correct", ",", "aic", ",", "chi", ",", "d"}], 

         "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 

   "\[IndentingNewLine]", "\[IndentingNewLine]", 

   RowBox[{"Validate", "[", 

    RowBox[{

     RowBox[{"fullset", "[", 

      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], 

   "\[IndentingNewLine]", 

   RowBox[{"(*", 

    RowBox[{

     RowBox[{"operate", "=", 

      RowBox[{

       RowBox[{"getoperate", "[", 

        RowBox[{"{", "6", "}"}], "]"}], "[", 

       RowBox[{"[", 

        RowBox[{

         RowBox[{"binsamps", "[", 

          RowBox[{"[", "2", "]"}], "]"}], "-", 

         RowBox[{"binsamps", "[", 

          RowBox[{"[", 

           RowBox[{"2", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

     ";", "\[IndentingNewLine]", 

     RowBox[{

      RowBox[{

       RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

       "operate"}], "=", 

      RowBox[{

       RowBox[{"getoperate", "[", 

        RowBox[{"{", "7", "}"}], "]"}], "[", 

       RowBox[{"[", 

        RowBox[{

         RowBox[{"binsamps", "[", 

          RowBox[{"[", "3", "]"}], "]"}], "-", 

         RowBox[{"binsamps", "[", 

          RowBox[{"[", 

           RowBox[{"3", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

     ";", "\[IndentingNewLine]", 

     RowBox[{

      RowBox[{

       RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

       "operate"}], "=", 

      RowBox[{

       RowBox[{"getoperate", "[", 

        RowBox[{"{", "11", "}"}], "]"}], "[", 

       RowBox[{"[", 

        RowBox[{

         RowBox[{"binsamps", "[", 

          RowBox[{"[", "4", "]"}], "]"}], "-", 

         RowBox[{"binsamps", "[", 

          RowBox[{"[", 

           RowBox[{"4", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

     ";", "\[IndentingNewLine]", 

     RowBox[{

      RowBox[{

       RowBox[{"Analyze", "[", "operate", "]"}], "\[IndentingNewLine]", 

       "operate"}], "=", 

      RowBox[{

       RowBox[{"getoperate", "[", 

        RowBox[{"{", "12", "}"}], "]"}], "[", 

       RowBox[{"[", 

        RowBox[{

         RowBox[{"binsamps", "[", 

          RowBox[{"[", "5", "]"}], "]"}], "-", 

         RowBox[{"binsamps", "[", 

          RowBox[{"[", 

           RowBox[{"5", ",", "1"}], "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], 

     ";", "\[IndentingNewLine]", 

     RowBox[{"Analyze", "[", "operate", "]"}]}], "*)"}]}]}]], "Input",

 CellChangeTimes->{{3.6060480417386765`*^9, 3.606048056866542*^9}, {

   3.6060480881703324`*^9, 3.6060481066733904`*^9}, {3.6060481873060026`*^9, 

   3.606048300242462*^9}, 3.606048495335621*^9, {3.606048544263419*^9, 

   3.606048640125902*^9}, {3.606049169340172*^9, 3.6060492719800425`*^9}, {

   3.6060494023204975`*^9, 3.6060494204735355`*^9}, {3.606049466673178*^9, 

   3.6060494777098093`*^9}, {3.606049523472427*^9, 3.606049585216958*^9}, {

   3.606049617320795*^9, 3.6060497134802947`*^9}, {3.6060497552636843`*^9, 

   3.6060500016607776`*^9}, {3.6060500415510592`*^9, 3.606050155798594*^9}, {

   3.606050186469348*^9, 3.60605021272285*^9}, {3.606050243060585*^9, 

   3.606050739660989*^9}, {3.606050796784256*^9, 3.606051157521889*^9}, {

   3.606051194217988*^9, 3.606051262377887*^9}, {3.60605129338266*^9, 

   3.6060512951077585`*^9}, {3.606051333116933*^9, 3.606051342789486*^9}, 

   3.60605144199116*^9, {3.6060515455570836`*^9, 3.606051545827099*^9}, 

   3.6060516850600624`*^9, {3.60855276153125*^9, 3.60855278334375*^9}}],



Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "1", ",", "2", ",", "5", ",", "7", ",", "10", ",", "14", ",", "15", ",", 

   "16", ",", "20", ",", "21", ",", "23", ",", "24", ",", "27", ",", "28", 

   ",", "32", ",", "35", ",", "38", ",", "42"}], "}"}]], "Print",

 CellChangeTimes->{{3.606048631991437*^9, 3.606048640934949*^9}, 

   3.6060488164139853`*^9, {3.606048856718291*^9, 3.6060489476834936`*^9}, {

   3.606048982793502*^9, 3.606049001220556*^9}, 3.6060491328320837`*^9, {

   3.606049218038957*^9, 3.6060492725860767`*^9}, {3.606049925330412*^9, 

   3.60605000222681*^9}, {3.6060500435981765`*^9, 3.6060500790892067`*^9}, 

   3.6060501193025064`*^9, {3.6060501566646433`*^9, 3.6060501603998575`*^9}, {

   3.606050190852599*^9, 3.6060502133858876`*^9}, {3.6060502469988103`*^9, 

   3.606050594631694*^9}, {3.606050628164612*^9, 3.606050693861369*^9}, {

   3.606050724189104*^9, 3.606050751937691*^9}, {3.606050883006188*^9, 

   3.6060509832679224`*^9}, {3.60605101417269*^9, 3.6060511252630444`*^9}, {

   3.6060511579299126`*^9, 3.606051254538438*^9}, {3.60855277421875*^9, 

   3.608552787078125*^9}}],



Cell[BoxData[

 RowBox[{

  StyleBox[

   RowBox[{"ProbitModelFit", "::", "rank"}], "MessageName"], 

  RowBox[{

  ":", " "}], "\<\"The rank of the design matrix \\!\\(1\\)\

 is less than the number of terms \\!\\(7\\) in \

the model. The model and results based upon it may contain significant \

numerical error. \\!\\(\\*ButtonBox[\\\">>\\\", ButtonStyle->\\\

\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/ProbitModelFit\\\", \

ButtonNote -> \\\"ProbitModelFit::rank\\\"]\\)\"\>"}]], "Message", "MSG",

 CellChangeTimes->{

  3.606051125298046*^9, {3.6060511577879047`*^9, 3.606051254353428*^9}, {

   3.60855277403125*^9, 3.608552787078125*^9}}],



Cell[BoxData[

 RowBox[{"{", 

  RowBox[{

  "1.`", ",", "1.`", ",", "14.000000006522255`", ",", 

   "3.2611250369330696`*^-9", ",", "6.430850378752055`*^-200"}], 

  "}"}]], "Output",

 CellChangeTimes->{{3.6060480221895585`*^9, 3.6060480440878105`*^9}, {

   3.606048090379459*^9, 3.6060481078584585`*^9}, {3.606048563218504*^9, 

   3.6060485866238422`*^9}, {3.6060486319884367`*^9, 3.6060486409319487`*^9}, 

   3.6060488164099855`*^9, {3.6060488567142906`*^9, 3.6060489476794934`*^9}, {

   3.6060489827895017`*^9, 3.6060490012175555`*^9}, 3.606049132828083*^9, {

   3.606049217796943*^9, 3.6060492723510637`*^9}, {3.606049925092398*^9, 

   3.6060500018897905`*^9}, {3.606050043446168*^9, 3.606050078836192*^9}, 

   3.6060501191814995`*^9, {3.606050156549637*^9, 3.6060501602078457`*^9}, {

   3.606050190669588*^9, 3.6060502133808875`*^9}, {3.60605024699481*^9, 

   3.6060505946276937`*^9}, {3.606050628160611*^9, 3.6060506938573694`*^9}, {

   3.6060507241841035`*^9, 3.606050751933691*^9}, {3.6060508830021877`*^9, 

   3.606050983235921*^9}, {3.6060510141396885`*^9, 3.606051125258044*^9}, {

   3.6060511579259124`*^9, 3.6060512545334377`*^9}, {3.608552774953125*^9, 

   3.6085527875625*^9}}]

}, Open  ]]

},

WindowSize->{1162, 860},

WindowMargins->{{Automatic, 245}, {13, Automatic}},

FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (October 6, 2011)",

StyleDefinitions->"Default.nb"

]

(* End of Notebook Content *)



(* Internal cache information *)

(*CellTagsOutline

CellTagsIndex->{}

*)

(*CellTagsIndex

CellTagsIndex->{}

*)

(*NotebookFileOutline

Notebook[{

Cell[557, 20, 2979, 84, 212, "Input"],

Cell[3539, 106, 9243, 181, 552, "Input"],

Cell[12785, 289, 145, 2, 31, "Input"],

Cell[CellGroupData[{

Cell[12955, 295, 6412, 162, 572, "Input"],


Cell[19370, 459, 299, 4, 23, "Print"],

Cell[19672, 465, 514, 9, 30, "Output"],

Cell[CellGroupData[{

Cell[20211, 478, 72, 1, 23, "Print"],

Cell[20286, 481, 137, 2, 23, "Print"]

}, Open  ]],

Cell[20438, 486, 516, 9, 30, "Output"],

Cell[20957, 497, 515, 9, 30, "Output"],

Cell[21475, 508, 513, 9, 30, "Output"],

Cell[21991, 519, 516, 9, 30, "Output"],

Cell[22510, 530, 513, 9, 30, "Output"]

}, Open  ]],

Cell[CellGroupData[{

Cell[23060, 544, 6749, 170, 552, "Input"],

Cell[29812, 716, 1102, 17, 23, "Print"],

Cell[30917, 735, 707, 13, 21, "Message"],

Cell[31627, 750, 1189, 19, 33, "Output"]


}, Open  ]]

}

]

*)



(* End of internal cache information *)

